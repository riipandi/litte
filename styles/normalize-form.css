/* Form normalization and styling for desktop applications */

:root {
    /* Form variables - based on Apple Human Interface Guidelines */
    --leading-inputs: 140%;
    --padding-inputs-v: 0.4em;
    --padding-inputs-h: 0.6em;
    --margin-label: 0.4em;
    --margin-form-gap: 1em;
    --margin-btn-gap: 0.5em;
    --width-input-border: 1px;
    --width-inputs: 200px;
    --width-textarea: 320px;
    --height-textarea: 120px;
    --opacity-input-disabled: 0.5;
    --transition-duration-inputs: 150ms;
    --transition-function-inputs: ease-out;
    --transition-inputs: color var(--transition-duration-inputs), background-color
        var(--transition-duration-inputs), border-color var(--transition-duration-inputs)
        var(--transition-function-inputs);
    --input-font-size: 0.9375rem; /* 15px at 16px base */
    --label-font-size: 0.875rem; /* 14px at 16px base */
    --control-height: 2em;
}

:read-only:not(label, button, input[type="button"], input[type="submit"], input[type="reset"]) {
    cursor: default;
}

:disabled {
    opacity: var(--opacity-input-disabled);
    cursor: not-allowed;
}

/* All elements regardless of types */
input,
select,
option,
textarea,
button,
datalist,
fieldset,
legend,
optgroup,
output,
input::file-selector-button {
    font: inherit;
    font-size: var(--input-font-size);
    color: inherit;
    accent-color: var(--color-primary);
    transition: var(--transition-inputs);
    line-height: var(--leading-inputs);
    box-sizing: border-box;
    margin: 0;
}

/* All elements with types */
/* Select, Buttons and text-fields */
select,
textarea,
input[type="date"],
input[type="datetime-local"],
input[type="email"],
input[type="month"],
input[type="number"],
input[type="password"],
input[type="search"],
input[type="tel"],
input[type="text"],
input[type="time"],
input[type="url"],
input[type="week"],
button,
input[type="reset"],
input[type="submit"],
input[type="button"],
input::file-selector-button {
    border: var(--width-input-border) solid var(--color-border);
    padding: var(--padding-inputs-v) var(--padding-inputs-h);
    border-radius: var(--radius-sm);
    background-color: var(--color-input);
}

/* Make select consistent across browsers */
select {
    appearance: none;
    -webkit-appearance: none;
    -moz-appearance: none;
    background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='m6 9 6 6 6-6'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 0.5em center;
    background-size: 0.8em;
    padding-right: 2em;
}

select::-ms-expand {
    display: none;
}

/* Remove default focus outlines */
select:focus,
textarea:focus,
input[type="date"]:focus,
input[type="datetime-local"]:focus,
input[type="email"]:focus,
input[type="month"]:focus,
input[type="number"]:focus,
input[type="password"]:focus,
input[type="search"]:focus,
input[type="tel"]:focus,
input[type="text"]:focus,
input[type="time"]:focus,
input[type="url"]:focus,
input[type="week"]:focus,
button:focus,
input[type="reset"]:focus,
input[type="submit"]:focus,
input[type="button"]:focus,
input::file-selector-button:focus {
    outline: 0;
}

/* All text-fields x select */
select,
textarea,
input[type="date"],
input[type="datetime-local"],
input[type="email"],
input[type="month"],
input[type="number"],
input[type="password"],
input[type="search"],
input[type="tel"],
input[type="text"],
input[type="time"],
input[type="url"],
input[type="week"] {
    width: var(--width-inputs);
    max-width: 100%;
    min-height: var(--control-height);
}

/* Hover and active states */
select:hover:not([readonly], [disabled]),
select:active:not([readonly], [disabled]),
textarea:hover:not([readonly], [disabled]),
textarea:active:not([readonly], [disabled]),
input[type="date"]:hover:not([readonly], [disabled]),
input[type="date"]:active:not([readonly], [disabled]),
input[type="datetime-local"]:hover:not([readonly], [disabled]),
input[type="datetime-local"]:active:not([readonly], [disabled]),
input[type="email"]:hover:not([readonly], [disabled]),
input[type="email"]:active:not([readonly], [disabled]),
input[type="month"]:hover:not([readonly], [disabled]),
input[type="month"]:active:not([readonly], [disabled]),
input[type="number"]:hover:not([readonly], [disabled]),
input[type="number"]:active:not([readonly], [disabled]),
input[type="password"]:hover:not([readonly], [disabled]),
input[type="password"]:active:not([readonly], [disabled]),
input[type="search"]:hover:not([readonly], [disabled]),
input[type="search"]:active:not([readonly], [disabled]),
input[type="tel"]:hover:not([readonly], [disabled]),
input[type="tel"]:active:not([readonly], [disabled]),
input[type="text"]:hover:not([readonly], [disabled]),
input[type="text"]:active:not([readonly], [disabled]),
input[type="time"]:hover:not([readonly], [disabled]),
input[type="time"]:active:not([readonly], [disabled]),
input[type="url"]:hover:not([readonly], [disabled]),
input[type="url"]:active:not([readonly], [disabled]),
input[type="week"]:hover:not([readonly], [disabled]),
input[type="week"]:active:not([readonly], [disabled]) {
    border-color: var(--color-muted-foreground);
}

/* Focus states */
select:focus:not([readonly], [disabled]),
textarea:focus:not([readonly], [disabled]),
input[type="date"]:focus:not([readonly], [disabled]),
input[type="datetime-local"]:focus:not([readonly], [disabled]),
input[type="email"]:focus:not([readonly], [disabled]),
input[type="month"]:focus:not([readonly], [disabled]),
input[type="number"]:focus:not([readonly], [disabled]),
input[type="password"]:focus:not([readonly], [disabled]),
input[type="search"]:focus:not([readonly], [disabled]),
input[type="tel"]:focus:not([readonly], [disabled]),
input[type="text"]:focus:not([readonly], [disabled]),
input[type="time"]:focus:not([readonly], [disabled]),
input[type="url"]:focus:not([readonly], [disabled]),
input[type="week"]:focus:not([readonly], [disabled]) {
    border-color: var(--color-primary);
    box-shadow: 0 0 0 2px rgba(var(--color-primary), 0.25);
}

/* Valid states */
select:required:valid:hover:not([readonly], [disabled]),
select:required:valid:active:not([readonly], [disabled]),
textarea:required:valid:hover:not([readonly], [disabled]),
textarea:required:valid:active:not([readonly], [disabled]),
input[type="date"]:required:valid:hover:not([readonly], [disabled]),
input[type="date"]:required:valid:active:not([readonly], [disabled]),
input[type="datetime-local"]:required:valid:hover:not([readonly], [disabled]),
input[type="datetime-local"]:required:valid:active:not([readonly], [disabled]),
input[type="email"]:required:valid:hover:not([readonly], [disabled]),
input[type="email"]:required:valid:active:not([readonly], [disabled]),
input[type="month"]:required:valid:hover:not([readonly], [disabled]),
input[type="month"]:required:valid:active:not([readonly], [disabled]),
input[type="number"]:required:valid:hover:not([readonly], [disabled]),
input[type="number"]:required:valid:active:not([readonly], [disabled]),
input[type="password"]:required:valid:hover:not([readonly], [disabled]),
input[type="password"]:required:valid:active:not([readonly], [disabled]),
input[type="search"]:required:valid:hover:not([readonly], [disabled]),
input[type="search"]:required:valid:active:not([readonly], [disabled]),
input[type="tel"]:required:valid:hover:not([readonly], [disabled]),
input[type="tel"]:required:valid:active:not([readonly], [disabled]),
input[type="text"]:required:valid:hover:not([readonly], [disabled]),
input[type="text"]:required:valid:active:not([readonly], [disabled]),
input[type="time"]:required:valid:hover:not([readonly], [disabled]),
input[type="time"]:required:valid:active:not([readonly], [disabled]),
input[type="url"]:required:valid:hover:not([readonly], [disabled]),
input[type="url"]:required:valid:active:not([readonly], [disabled]),
input[type="week"]:required:valid:hover:not([readonly], [disabled]),
input[type="week"]:required:valid:active:not([readonly], [disabled]) {
    border-color: var(--color-success);
}

select:required:valid:focus:not([readonly], [disabled]),
textarea:required:valid:focus:not([readonly], [disabled]),
input[type="date"]:required:valid:focus:not([readonly], [disabled]),
input[type="datetime-local"]:required:valid:focus:not([readonly], [disabled]),
input[type="email"]:required:valid:focus:not([readonly], [disabled]),
input[type="month"]:required:valid:focus:not([readonly], [disabled]),
input[type="number"]:required:valid:focus:not([readonly], [disabled]),
input[type="password"]:required:valid:focus:not([readonly], [disabled]),
input[type="search"]:required:valid:focus:not([readonly], [disabled]),
input[type="tel"]:required:valid:focus:not([readonly], [disabled]),
input[type="text"]:required:valid:focus:not([readonly], [disabled]),
input[type="time"]:required:valid:focus:not([readonly], [disabled]),
input[type="url"]:required:valid:focus:not([readonly], [disabled]),
input[type="week"]:required:valid:focus:not([readonly], [disabled]) {
    border-color: var(--color-success);
    box-shadow: 0 0 0 2px rgba(var(--color-success), 0.25);
}

/* Invalid states */
select:required:invalid:hover,
select:required:invalid:active,
textarea:required:invalid:hover,
textarea:required:invalid:active,
input[type="date"]:required:invalid:hover,
input[type="date"]:required:invalid:active,
input[type="datetime-local"]:required:invalid:hover,
input[type="datetime-local"]:required:invalid:active,
input[type="email"]:required:invalid:hover,
input[type="email"]:required:invalid:active,
input[type="month"]:required:invalid:hover,
input[type="month"]:required:invalid:active,
input[type="number"]:required:invalid:hover,
input[type="number"]:required:invalid:active,
input[type="password"]:required:invalid:hover,
input[type="password"]:required:invalid:active,
input[type="search"]:required:invalid:hover,
input[type="search"]:required:invalid:active,
input[type="tel"]:required:invalid:hover,
input[type="tel"]:required:invalid:active,
input[type="text"]:required:invalid:hover,
input[type="text"]:required:invalid:active,
input[type="time"]:required:invalid:hover,
input[type="time"]:required:invalid:active,
input[type="url"]:required:invalid:hover,
input[type="url"]:required:invalid:active,
input[type="week"]:required:invalid:hover,
input[type="week"]:required:invalid:active {
    border-color: var(--color-destructive);
}

select:required:invalid:focus,
textarea:required:invalid:focus,
input[type="date"]:required:invalid:focus,
input[type="datetime-local"]:required:invalid:focus,
input[type="email"]:required:invalid:focus,
input[type="month"]:required:invalid:focus,
input[type="number"]:required:invalid:focus,
input[type="password"]:required:invalid:focus,
input[type="search"]:required:invalid:focus,
input[type="tel"]:required:invalid:focus,
input[type="text"]:required:invalid:focus,
input[type="time"]:required:invalid:focus,
input[type="url"]:required:invalid:focus,
input[type="week"]:required:invalid:focus {
    border-color: var(--color-destructive);
    box-shadow: 0 0 0 2px rgba(var(--color-destructive), 0.25);
}

/* Text selection */
select::selection,
textarea::selection,
input[type="date"]::selection,
input[type="datetime-local"]::selection,
input[type="email"]::selection,
input[type="month"]::selection,
input[type="number"]::selection,
input[type="password"]::selection,
input[type="search"]::selection,
input[type="tel"]::selection,
input[type="text"]::selection,
input[type="time"]::selection,
input[type="url"]::selection,
input[type="week"]::selection {
    background-color: var(--color-primary);
    color: var(--color-primary-foreground);
}

/* Select options styling */
select option {
    background-color: var(--color-input);
    color: var(--color-foreground);
    padding: 0.4em 0.6em;
    font-size: var(--input-font-size);
}

select:not([disabled], [readonly]) option:focus,
select:not([disabled], [readonly]) option:active,
select:not([disabled], [readonly]) option:hover,
select:not([disabled], [readonly]) option:checked {
    background-color: var(--color-primary);
    color: var(--color-primary-foreground);
}

/* Color input styling */
input[type="color"] {
    cursor: pointer;
    border-style: solid;
    border-radius: var(--radius-sm);
    border-color: var(--color-border);
    background-color: var(--color-input);
    width: 3em;
    height: 2em;
    padding: 0.2em;
}

input[type="color"]:hover:not([disabled]),
input[type="color"]:active:not([disabled]) {
    border-color: var(--color-muted-foreground);
}

input[type="color"]:focus {
    outline: 0;
}

input[type="color"]:focus:not([disabled]) {
    border-color: var(--color-primary);
    box-shadow: 0 0 0 2px rgba(var(--color-primary), 0.25);
}

/* Number input specific styling */
input[type="number"] {
    -moz-appearance: textfield;
}

input[type="number"]::-webkit-inner-spin-button,
input[type="number"]::-webkit-outer-spin-button {
    -webkit-appearance: none;
    margin: 0;
}

/* Date input cross-browser styling */
input[type="date"],
input[type="datetime-local"],
input[type="month"],
input[type="time"],
input[type="week"] {
    min-height: var(--control-height);
    appearance: none;
    -webkit-appearance: none;
    -moz-appearance: none;
    background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Crect x='3' y='4' width='18' height='18' rx='2' ry='2'/%3E%3Cline x1='16' y1='2' x2='16' y2='6'/%3E%3Cline x1='8' y1='2' x2='8' y2='6'/%3E%3Cline x1='3' y1='10' x2='21' y2='10'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 0.5em center;
    background-size: 1em;
    padding-right: 2em;
}

/* Fix for date inputs in Safari */
input::-webkit-datetime-edit {
    padding: 0;
    line-height: 1;
    vertical-align: middle;
}

input::-webkit-datetime-edit-fields-wrapper {
    padding: 0;
}

input::-webkit-calendar-picker-indicator {
    background: transparent;
    cursor: pointer;
    position: absolute;
    right: 0;
    top: 0;
    bottom: 0;
    width: 2.5em;
    height: auto;
    opacity: 0;
    z-index: 1;
}

/* Buttons styling */
button,
input[type="reset"],
input[type="submit"],
input[type="button"],
input::file-selector-button {
    border-color: var(--color-primary);
    background-color: var(--color-primary);
    color: var(--color-primary-foreground);
    cursor: pointer;
    min-width: 5em;
    text-align: center;
    font-weight: 500;
    min-height: var(--control-height);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: var(--padding-inputs-v) 0.8em;
}

button:hover,
button:active,
input[type="reset"]:hover,
input[type="reset"]:active,
input[type="submit"]:hover,
input[type="submit"]:active,
input[type="button"]:hover,
input[type="button"]:active,
input::file-selector-button:hover,
input::file-selector-button:active {
    background-color: var(--color-accent);
    border-color: var(--color-accent);
}

button:focus,
input[type="reset"]:focus,
input[type="submit"]:focus,
input[type="button"]:focus,
input::file-selector-button:focus {
    background-color: var(--color-accent);
    border-color: var(--color-accent);
    box-shadow: 0 0 0 2px rgba(var(--color-accent), 0.25);
}

/* Secondary button style */
button.secondary,
input[type="button"].secondary {
    background-color: var(--color-secondary);
    border-color: var(--color-border);
    color: var(--color-secondary-foreground);
}

button.secondary:hover,
button.secondary:active,
input[type="button"].secondary:hover,
input[type="button"].secondary:active {
    background-color: var(--color-muted);
    border-color: var(--color-muted-foreground);
}

/* Labels */
label {
    cursor: pointer;
    display: block;
    font-size: var(--label-font-size);
    font-weight: 500;
    margin-bottom: 0.3em;
}

label + label,
label + input,
label + select,
label + button,
label + textarea {
    margin-top: var(--margin-label);
}

/* Fieldset styling */
fieldset {
    border: var(--width-input-border) solid var(--color-border);
    border-radius: var(--radius-sm);
    padding: 0.6em 0.8em;
    margin: 0.5em 0;
}

legend {
    padding: 0 0.5em;
    font-size: var(--label-font-size);
    font-weight: 500;
}

/* Checkbox and radio styling */
input[type="checkbox"],
input[type="radio"] {
    margin-right: 0.5em;
    vertical-align: -0.1em;
    width: 1em;
    height: 1em;
}

/* Improve checkbox/radio alignment in labels */
label:has(> input[type="checkbox"]),
label:has(> input[type="radio"]) {
    display: flex;
    align-items: center;
    gap: 0.5em;
}

label:has(> input[type="checkbox"]) > input,
label:has(> input[type="radio"]) > input {
    margin: 0;
}

/* Textarea styling */
textarea {
    width: var(--width-textarea);
    height: var(--height-textarea);
    resize: vertical;
    min-height: 3em;
    padding: 0.6em;
    line-height: 1.4;
}

textarea:read-only,
textarea:disabled {
    resize: none;
}

/* File input styling */
input[type="file"] {
    cursor: pointer;
    font-size: var(--input-font-size);
    padding: var(--padding-inputs-v) 0;
}

input[type="file"]::file-selector-button {
    margin-right: var(--margin-form-gap);
    font-size: var(--input-font-size);
    margin-inline: 0 0.6em;
}

/* Disabled label styling */
label:has(input:disabled) {
    opacity: var(--opacity-input-disabled);
    cursor: not-allowed;
}

label:has(input:disabled) :disabled {
    opacity: 1;
}

/* Focus ring for keyboard navigation */
button:focus-visible,
input:focus-visible,
select:focus-visible,
textarea:focus-visible {
    outline: 2px solid var(--color-ring);
    outline-offset: 1px;
}

/* Placeholder styling */
::placeholder {
    color: var(--color-muted-foreground);
    opacity: 0.7;
}

/* Form layout utilities */
.form-row {
    display: flex;
    gap: 0.8em;
    align-items: flex-start;
    margin-bottom: 0.6em;
}

.form-col {
    display: flex;
    flex-direction: column;
    gap: 0.6em;
}

/* Form groups */
.form-group {
    margin-bottom: 1em;
}

/* Inline form elements */
.form-inline label,
label.inline {
    display: inline-block;
    margin-right: 0.8em;
}

/* Form grid for desktop layouts */
.form-grid {
    display: grid;
    grid-template-columns: max-content 1fr;
    gap: 0.6em 0.8em;
    align-items: center;
}

.form-grid label {
    text-align: right;
    margin-top: 0;
    margin-bottom: 0;
}

.form-grid button,
.form-grid input[type="submit"],
.form-grid input[type="reset"] {
    grid-column: 2;
}

/* Form validation message styling */
.form-error {
    color: var(--color-destructive);
    font-size: 0.8125em;
    margin-top: 0.3em;
}

.form-success {
    color: var(--color-success);
    font-size: 0.8125em;
    margin-top: 0.3em;
}

/* Fix for Firefox inner focus ring */
select:-moz-focusring {
    color: transparent;
    text-shadow: 0 0 0 var(--color-foreground);
}

/* Fix for IE/Edge */
@media screen and (forced-colors: none), (forced-colors: active) {
    select {
        padding-right: 0.5em;
        background-image: none;
    }
}

/* Ensure consistent form element heights */
select,
input:not([type="checkbox"], [type="radio"], [type="range"], [type="color"]),
button,
textarea {
    height: auto;
    min-height: var(--control-height);
    box-sizing: border-box;
}

/* Apple-style form elements */
.form-apple select,
.form-apple input:not([type="checkbox"], [type="radio"], [type="range"], [type="color"]),
.form-apple button,
.form-apple textarea {
    border-radius: 0.5em;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
}

.form-apple button,
.form-apple input[type="submit"] {
    font-weight: 600;
    letter-spacing: -0.01em;
}

/* Compact form style */
.form-compact {
    --padding-inputs-v: 0.3em;
    --padding-inputs-h: 0.5em;
    --margin-label: 0.3em;
    --margin-form-gap: 0.8em;
    --control-height: 1.8em;
}

.form-compact label {
    font-size: 0.8125rem;
}

.form-compact input,
.form-compact select,
.form-compact button,
.form-compact textarea {
    font-size: 0.875rem;
}
